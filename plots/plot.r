

# take one out
acc <- c(0.375,0.769,0.783,0.833)
names(acc) <- c("w/o perspective","w/o filters","w/o polite","baseline")

pdf("../images/removing.pdf",width = 6,height = 1.1)
par(mar=c(1.5,6.5,0,0)+0.1)
par(mgp=c(.5,.5,0))
barplot(acc,horiz = TRUE,names.arg=names,las=1,axes = FALSE,xlab="F.5 score")
axis(1,at=c(0,.8))
dev.off()


acc=c(0.79,0.817,0.8098,0,0.799,0.821,0.757,0.783,0.8333)
names(acc)<-c('anger','negative','vader','length','polarity','subjectivity','tf_idf','word2vec','baseline')
pdf("../images/adding.pdf",width = 6,height = 2)
acc=sort(acc,decreasing = TRUE)
par(mar=c(1.5,6.5,0,0)+0.1)
par(mgp=c(.5,.5,0))
barplot(acc,horiz = TRUE,las=1,axes = FALSE,xlab="F.5 score")
axis(1,at=c(0,.8))
dev.off()




pdf("../images/years.pdf",width = 6,height = 1.5)
par(mar=c(1.5,3.5,.1,.2)+0.1)
par(mgp=c(2.5,.5,0))
dat <- c(0.00968054211035818, 0.009408075264602116, 0.0070710829921845925, 0.009415457041977247, 0.007055805003207184, 0.006018371872030409, 0.008950366151342554, 0.004840764331210191, 0.005729166666666666, 0.005698778833107192, 0.0038910505836575876, 0.004710248358549814, 0.006564973933191736, 0.007449856733524355, 0.004630179271043571, 0.007259073842302879, 0.006360587486989707, 0.006453884064773528, 0.005786779434676163, 0.007642294969773013, 0.006004140786749482, 0.006134342091810653, 0.007121716611172771, 0.006698395910453023, 0.0065200382508910715, 0.005590607778931395, 0.0071104860134396, 0.006016217630133403, 0.007283090563647878, 0.007738836505959794, 0.005571487095452683, 0.006094808126410835, 0.004954462659380692, 0.006294684488654025, 0.004591502077108083, 0.007135121360769573, 0.004943584971501686, 0.0069060016442861055, 0.006454843915196706, 0.00564569452215045, 0.006179805470471277, 0.00564652738565782, 0.004757700608200902, 0.005803491092315998, 0.005341927508719262, 0.00575283719470739, 0.00531699001542333, 0.005696442887885565, 0.005073608916243866, 0.006534474988733664, 0.00622601896763918, 0.004339022273647671, 0.005672426746806912, 0.00618069441919651, 0.005083179297597043, 0.0054019594685277145, 0.005292347844999456, 0.004949594206063253, 0.005176406484130228, 0.004814282371034068, 0.006355577855828734, 0.006115097024187934, 0.004667731236948778, 0.007959654879086158, 0.0050585980456844815, 0.005016181229773463, 0.004323235912469278, 0.005539274097452578, 0.0036226504736170087, 0.004626303841843625, 0.004228442969544506, 0.00419863906182134, 0.0036729891818990503, 0.004420546493291627, 0.004594219361353023, 0.004072807723250201, 0.0033486389812019584, 0.003270542301549071, 0.0035977558054695953, 0.003502027489599242, 0.0028635229213187967, 0.0031056648289476854, 0.0034446344161721816, 0.002886836027713626)
#lab <- c('2012-01', '2012_02_13', '2012_03_12', '2012_04_09', '2012_05_14', '2012_06_11', '2012_07_09', '2012_08_13', '2012_09_10', '2012_10_08', '2012_11_12', '2012_12_10', '2013_01_14', '2013_02_11', '2013_03_11', '2013_04_08', '2013_05_13', '2013_06_10', '2013_07_08', '2013_08_12', '2013_09_09', '2013_10_14', '2013_11_11', '2013_12_09', '2014_01_13', '2014_02_10', '2014_03_10', '2014_04_14', '2014_05_12', '2014_06_09', '2014_07_14', '2014_08_11', '2014_09_08', '2014_10_13', '2014_11_10', '2014_12_08', '2015_01_12', '2015_02_09', '2015_03_09', '2015_04_13', '2015_05_11', '2015_06_08', '2015_07_13', '2015_08_10', '2015_09_14', '2015_10_12', '2015_11_09', '2015_12_14', '2016_01_11', '2016_02_08', '2016_03_14', '2016_04_11', '2016_05_09', '2016_06_13', '2016_07_11', '2016_08_08', '2016_09_12', '2016_10_10', '2016_11_14', '2016_12_12', '2017_01_09', '2017_02_13', '2017_03_13', '2017_04_10', '2017_05_08', '2017_06_12', '2017_07_10', '2017_08_14', '2017_09_11', '2017_10_09', '2017_11_13', '2017_12_11', '2018_01_08', '2018_02_12', '2018_03_12', '2018_04_09', '2018_05_14', '2018_06_11', '2018_07_09', '2018_08_13', '2018_09_10', '2018_10_08', '2018_11_12', '2018_12_10')
plot(dat,axes = FALSE,xlab="",ylab="Toxic iss./all iss.",ylim=c(0,.01))
axis(1,at=seq(1,90,by=12), labels=seq(2012,2019))
axis(2,las=1,at=c(0,.01),labels=c("0%","1%"))
abline(lm(dat~seq(1,84)),col="grey",xlim=c(1,84))
dev.off()



pdf("../images/corporate.pdf",width = 6,height = .7)
par(mar=c(1.5,6.5,0,0)+0.1)
par(mgp=c(.5,.5,0))
c1=c(0.001336563361456854, 0.0, 0.002242870874719641, 0.0012658227848101266, 0.001644736842105263, 0.004760614622440686, 0.008289473684210527, 0.0010355540214014498, 0.002219685438863521, 0.0025284450063211127, 0.0002531004808909137, 0.0017945886250690225, 0.004, 0.0008278145695364238, 0.004936530324400564, 0.0, 0.0017099720565541979, 0.0011210762331838565, 0.0019212295869356388, 0.004418828049951969, 0.0004362050163576881, 0.002276176024279211, 0.0014697236919459142, 0.0029668088262562583, 0.004686525151985607, 0.004880154040236372, 0.0015335983224312227, 0.000944733112895607, 0.0014659174199853407, 0.0017903201335153999, 0.009971726507159578, 0.0049301561216105174, 0.0027427637721755367, 0.02857142857142857, 0.001934984520123839, 0.0038117188192536124, 0.0029653284671532845, 0.002995293110825845, 0.0022435897435897434, 0.0, 0.00036643459142543056, 0.004572853876532945, 0.0006309148264984228, 0.003100522193211488, 0.0006997900629811056, 0.00042140750105351877, 0.001978332548280735, 0.0, 0.0038048745468250837, 0.0041183077499064025)
c2=c(0.005796816663391629, 0.006297918948521358, 0.0028653295128939827, 0.005927475592747559, 0.004812319538017324, 0.00211864406779661, 0.00474158368895211, 0.0021640763328742867, 0.0, 0.002711006687149828, 0.004396087482140895, 0.006502040533997371, 0.005754212905877518, 0.0610236220472441, 0.00038095238095238096, 0.0056036678553234845, 0.009523809523809525, 0.0026200873362445414, 0.015848558221439577, 0.004019789734075448, 0.006886403766921719, 0.0017168721710628999, 0.0073277967757694185, 0.006151322534344884, 0.005633395926621407, 0.0024813895781637717, 0.004439681567666871, 0.0042796005706134095, 0.004459270269803135, 0.006235328638497652, 0.0019047619047619048, 0.008914100486223663, 0.0044014084507042256, 0.0028129395218002813, 0.005390835579514825, 0.0, 0.0035708212888964463, 0.0057194123584165075, 0.006339144215530904, 0.002786112301757394, 0.022900763358778626, 0.0010611956137247967, 0.005246839971380873, 0.0005707762557077625, 0.006273448551571437, 0.00040290088638195, 0.003401360544217687, 0.0, 0.0001457725947521866)
boxplot(c1,c2, horizontal = TRUE,outline = FALSE,axes=FALSE,xlab="Rate of toxic issues",ylim=c(0,.01))
axis(1,at=c(0,.01),labels=c("0%","1%"))
axis(2,at=c(1,2),labels=c("Corporate","Noncorporate"),las=1,lty=0)
dev.off()


pdf("../images/langs.pdf",width = 6,height = 1.5)
par(mar=c(1.5,6.5,0,0)+0.1)
par(mgp=c(.5,.5,0))
c1=c(0.0012185215272136475, 0.0, 0.011111111111111112, 0.0, 0.0, 0.0, 0.0035842293906810036, 0.0, 0.003083247687564234, 0.0, 0.002863278453829635, 0.0, 0.0, 0.011494252873563218, 0.0, 0.0006313131313131314, 0.00261210274270788, 0.0011500862564692352, 0.0, 0.0, 0.01079447322970639, 0.0011910433539780848, 0.0, 0.0014044943820224719, 0.0, 0.0018951358180669614, 0.0, 0.0, 0.0, 0.0)
c2=c(0.0020964360587002098, 0.007518796992481203, 0.005242059821153253, 0.006118286879673691, 0.0, 0.0, 0.007633587786259542, 0.006366530241018645, 0.0, 0.0019342359767891683, 0.0017513134851138354, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0015015015015015015, 0.0006648936170212766, 0.004301075268817204, 0.0, 0.003384731101918014, 0.004860267314702308, 0.0012091898428053204, 0.004592700024172105, 0.00411522633744856, 0.0, 0.008849557522123894, 0.005714285714285714, 0.0, 0.0)
c3=c(0.002152957870528943, 0.003242241778601204, 0.003009939801203976, 0.007476635514018692, 0.013100436681222707, 0.0036798528058877645, 0.0016490765171503958, 0.0012698412698412698, 0.003766693299851615, 0.0061823802163833074, 0.0, 0.0, 0.0002469257741123018, 0.0070842654735272185, 0.0025426807119505995, 0.004803843074459567, 0.010416666666666666, 0.0016769144773616546, 0.0014367816091954023, 0.0026023184291459663, 0.0, 0.0066100094428706326, 0.0008613264427217916, 0.011194029850746268, 0.0014124293785310734, 0.006986318459683121, 0.0, 0.007696536558548653, 0.0017231476163124641)
c4=c(0.0031746031746031746, 0.0, 0.006211180124223602, 0.0078125, 0.0, 0.009411764705882352, 0.0, 0.0030959752321981426, 0.0, 0.01984126984126984, 0.0, 0.012927756653992395, 0.0, 0.0045871559633027525, 0.0, 0.005128205128205128, 0.006993006993006993, 0.014084507042253521, 0.019913419913419914, 0.0019646365422396855, 0.0027526543452615023, 0.004901960784313725, 0.008771929824561403, 0.03571428571428571, 0.0, 0.0, 0.01657323909334633, 0.009622501850481125, 0.0, 0.0018656716417910447, 0.0)
c5=c(0.0015041363750313362, 0.0, 0.004555424329340307, 0.003303964757709251, 0.0037200814206499616, 0.00611545988258317, 0.00539291217257319, 0.005349023803155924, 0.0042775665399239545, 0.006628787878787879, 0.0015290519877675841, 0.00038255547054322876, 0.008565310492505354, 0.0033519553072625698, 0.003181336161187699, 0.004069767441860465, 0.004625614339404453, 0.004932182490752158, 0.00487012987012987, 0.018848700967906265, 0.0055058499655884375, 0.0, 0.0051292572835453425, 0.0038508934072704866, 0.0, 0.005426646706586827, 0.005536417322834645, 0.0035257822829440283, 0.021551724137931036, 0.0049382716049382715)
c6=c(0.013356311934510987, 0.0025368638021246235, 0.001129305477131564, 0.0, 0.002512562814070352, 0.008, 0.008110300081103, 0.0023459686381034697, 0.0, 0.0021413276231263384, 0.02127659574468085, 0.0022393232267581354, 0.0, 0.005582693649685973, 0.0025887175062021357, 0.001518141794443601, 0.014118685197440988, 0.0036319612590799033, 0.0056179775280898875, 0.005652711535064477, 0.004878048780487805, 0.008130081300813009, 0.0025575447570332483, 0.17865429234338748, 0.0011890606420927466, 0.007281553398058253, 0.00831836657529067, 0.012244897959183673, 0.006090837490154897)
c7=c(0.00769503965905055, 0.010103845074375527, 0.011738648947951274, 0.006951871657754011, 0.001954879272996249, 0.0024984384759525295, 0.0, 0.008670520231213872, 0.0042985541227041815, 0.025, 0.01056338028169014, 0.009280742459396751, 0.005945303210463734, 0.003702234563004099, 0.008178735288250548, 0.004231052244297278, 0.005230125523012552, 0.005473517491964411, 0.01312881840634343, 0.015727967665407256, 0.004484304932735426, 0.004585450489527822, 0.0037641154328732747, 0.002789400278940028, 0.007713498622589532, 0.0024405125076266015, 0.010836923880402142, 0.002573634543894767, 0.013675213675213675, 0.007716965451739285, 0.006629541235746487)

lab=c("R","Haskell","Java","Lua","Javascript","Python","Ruby")
boxplot(c1,c2,c3,c4,c5,c6,c7, horizontal = TRUE,outline = FALSE,axes=FALSE,xlab="Rate of toxic issues",ylim=c(0,.02))
axis(1,at=c(0,.02),labels=c("0%","2%"))
axis(2,at=seq(1,7),labels=lab,las=1,lty=0)
dev.off()